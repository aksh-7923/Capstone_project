{
	"name": "Ad-hocqueries",
	"properties": {
		"content": {
			"query": "---Q3\nSELECT\n    [fuel] AS \"Fuel\",\n    AVG(CAST(FLOOR(CAST(SUBSTRING([mileage], 1, CHARINDEX(' ', [mileage]) - 1) AS DECIMAL(10, 1))) AS INT)) AS \"Avg. Mileage (Integer)\"\nFROM\n    [silver].[cars]\nGROUP BY\n    [fuel];\n\n---Q4\nSelect [model]\nFROM [silver].[cars]\n\n\n--- Customer Information for High-Value Policies\n\nSELECT c.[CustomerID], c.[Marital], c.[Education], c.[Balance], p.[policy_annual_premium]\n\nFROM [silver].[customers] c\n\nINNER JOIN [silver].[policy] p ON c.[CustomerID] = p.[customer_id]\n\nWHERE p.[policy_annual_premium] > 1800\n\nORDER BY p.[policy_annual_premium] DESC;\n\n \n--- Total Sales by Year/Month\n\nWITH SalesData AS (\n\n    SELECT\n\n        YEAR(s.[sold_on]) AS \"Year\",\n\n        MONTH(s.[sold_on]) AS \"Month\",\n\n        SUM(s.[selling_price]) AS \"Total_Sales\"\n\n    FROM\n\n        [silver].[sales] s\n\n    WHERE\n\n        s.[sold_on] IS NOT NULL\n\n    GROUP BY\n\n        YEAR(s.[sold_on]),MONTH(s.[sold_on])\n\n)\n\nSELECT * FROM SalesData;\n\n \n--- Top-Selling Car Models by State\n\nWITH RankedSales AS (\n\n    SELECT\n\n        s.[State],\n\n        c.[model] AS \"CarModel\",\n\n        RANK() OVER (PARTITION BY s.[State] ORDER BY COUNT(s.sales_id) DESC) AS \"Rank\"\n\n    FROM [silver].[sales] s\n\n    JOIN [silver].[cars] c ON s.[car_id] = c.[car_id]\n\n    GROUP BY s.[State], c.[model]\n\n)\n\n \n\nSELECT [State], CarModel\n\nFROM [RankedSales]\n\nWHERE Rank = 1;\n\n\n\n",
			"metadata": {
				"language": "sql"
			},
			"currentConnection": {
				"databaseName": "secondcars_silver",
				"poolName": "Built-in"
			},
			"resultLimit": 5000
		},
		"type": "SqlQuery"
	}
}